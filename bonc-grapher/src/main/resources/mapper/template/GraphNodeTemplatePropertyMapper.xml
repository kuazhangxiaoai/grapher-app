<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.bonc.graph.template.mapper.GraphNodeTemplatePropertyMapper">

    <resultMap id="BaseResultMap" type="com.bonc.graph.template.domain.GraphNodeTemplateProperty">
        <id column="node_template_property_id" property="nodeTemplatePropertyId"/>
        <result column="node_template_id" property="nodeTemplateId"/>
        <result column="property_key" property="propertyKey"/>
        <result column="property_type" property="propertyType"/>
        <result column="create_time" property="createTime"/>
        <result column="update_time" property="updateTime"/>
        <result column="is_delete_flag" property="isDeleteFlag"/>
    </resultMap>

    <select id="selectByNodeTemplateId" resultMap="BaseResultMap">
        select * from graph_node_template_property
        where node_template_id = #{nodeTemplateId} and is_delete_flag = '0'
    </select>

    <insert id="batchInsert">
        insert into graph_node_template_property
        (node_template_id, property_key, property_type, create_time, update_time, is_delete_flag)
        values
        <foreach collection="list" item="item" separator=",">
            (#{item.nodeTemplateId}, #{item.propertyKey}, #{item.propertyType}, now(), now(), '0')
        </foreach>
    </insert>

    <update id="updateDeleteFlagByNodeTemplateId">
        update graph_node_template_property
        set is_delete_flag = #{isDeleteFlag}, update_time = now()
        where node_template_id = #{nodeTemplateId}
    </update>

</mapper>